
Starting Iterations
================================================================================
Iteration 1
time/training: 59.793567419052124
time/total: 61.84721517562866
time/evaluation: 6.604194641113281e-05
training/train_loss_mean: 1.3994082837045192
training/train_loss_std: 0.0387134584009709
training/action_error: 1.392421007156372
================================================================================
Iteration 2
time/training: 58.56130814552307
time/total: 120.4115903377533
time/evaluation: 6.532669067382812e-05
training/train_loss_mean: 1.3928797998547553
training/train_loss_std: 0.0015097052205663925
training/action_error: 1.3937901258468628
================================================================================
Iteration 3
time/training: 59.454986333847046
time/total: 179.86941862106323
time/evaluation: 6.67572021484375e-05
training/train_loss_mean: 1.392708613860607
training/train_loss_std: 0.0013896927811094923
training/action_error: 1.3921992778778076
================================================================================
Iteration 4
time/training: 58.98854875564575
time/total: 238.86073184013367
time/evaluation: 7.2479248046875e-05
training/train_loss_mean: 1.392607894027233
training/train_loss_std: 0.0011370758588906578
training/action_error: 1.3922146558761597
================================================================================
Iteration 5
time/training: 59.653709173202515
time/total: 298.51731276512146
time/evaluation: 6.628036499023438e-05
training/train_loss_mean: 1.3925629604876042
training/train_loss_std: 0.0011483492392416162
training/action_error: 1.3922055959701538
================================================================================
Iteration 6
time/training: 59.925108909606934
time/total: 358.4452826976776
time/evaluation: 6.389617919921875e-05
training/train_loss_mean: 1.392551313841343
training/train_loss_std: 0.001033292191923879
training/action_error: 1.3921955823898315
================================================================================
Iteration 7
time/training: 61.00199270248413
time/total: 419.449969291687
time/evaluation: 6.699562072753906e-05
training/train_loss_mean: 1.3925241471767424
training/train_loss_std: 0.000991290624329564
training/action_error: 1.3921936750411987
================================================================================
Iteration 8
time/training: 62.33118438720703
time/total: 481.78398299217224
time/evaluation: 6.985664367675781e-05
training/train_loss_mean: 1.3925094031691552
training/train_loss_std: 0.000998683729459343
training/action_error: 1.3921927213668823
[?25h
Traceback (most recent call last):
  File "/home/moonlab/decision_transformer/decision_tr/src/train.py", line 279, in <module>
    experiment(variant=vars(args))
  File "/home/moonlab/decision_transformer/decision_tr/src/train.py", line 232, in experiment
    outputs = trainer.train_iteration(num_steps=num_steps_per_iter, iter_num=iter+1, print_logs=True)
  File "/home/moonlab/decision_transformer/decision_tr/src/training/trainer.py", line 30, in train_iteration
    train_loss = self.train_step()
  File "/home/moonlab/decision_transformer/decision_tr/src/training/seq_trainer.py", line 25, in train_step
    state_preds, action_preds, reward_preds = self.model.forward(
  File "/home/moonlab/decision_transformer/decision_tr/src/model/decision_transformer.py", line 98, in forward
    transformer_outputs = self.transformer(
  File "/home/moonlab/decision_transformer/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moonlab/decision_transformer/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moonlab/decision_transformer/decision_tr/src/model/trajectory_gpt2.py", line 745, in forward
    outputs = block(
  File "/home/moonlab/decision_transformer/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moonlab/decision_transformer/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moonlab/decision_transformer/decision_tr/src/model/trajectory_gpt2.py", line 314, in forward
    attn_outputs = self.attn(
  File "/home/moonlab/decision_transformer/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/moonlab/decision_transformer/.venv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/moonlab/decision_transformer/decision_tr/src/model/trajectory_gpt2.py", line 243, in forward
    attn_outputs = self._attn(query, key, value, attention_mask, head_mask, output_attentions)
  File "/home/moonlab/decision_transformer/decision_tr/src/model/trajectory_gpt2.py", line 184, in _attn
    w = nn.Softmax(dim=-1)(w)
KeyboardInterrupt